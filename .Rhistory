p.val< -2*pt(-0,02, df=99, lower.tail=FALSE)
p.val < -2*pt(-0,02, df=99, lower.tail=FALSE)
p.val <- 2*pt(-abs(-0.02), df=99)
p.val < -2*pt(-4.09, df=39, lower.tail=FALSE)
p.val <- 2*pt(-abs(-4.09), df=39)
library(lubridate)
install.packages("lubridate")
library(lubridate)
library(dplyr)
library(ggplot2)
crime <- read.csv("crimes.csv", header = TRUE)
crime <- read.csv("crimes.csv", header = TRUE)
getwd()
crime <- read.csv("C:\Users\HP\Documents\crimes.csv", header = TRUE)
crime <- read.csv("C:/Users/HP/Documents/crimes.csv", header = TRUE)
file.exists("C:/Users/HP/Documents/crimes.csv")
file.exists("C:/Users/HP/Documents/crimes.csv")
crime <- read.csv("C:/Users/HP/Documents/crimes.csv", header = TRUE)
str(crime)
crime$POSIX <- ymd_hms(as.character(crime$Dates))
crime$Dates <- as.Date(ymd_hms(as.character(crime$Dates)))
moon <- read.csv("moon.csv", header = TRUE)
moon <- read.csv("C:/Users/HP/Documents/moon.csv", header = TRUE)
moon$date <- as.Date(moon$date, "%m/%d/%Y")
full_data <- merge(crime, moon, by.x = "Dates", by.y="date")
full_data <- inner_join(crime, moon, by=c("Dates"="date"))
date_phase <- full_data %>%
group_by(Dates, phase) %>%
count() %>%
arrange(desc(n))
glimpse(date_phase)
library(ggplot2)
ggplot(date_phase, aes(Dates, n)) +
geom_line(alpha = 0.5) +
labs(title = "Злочини в Сан-Франциско (2003-2015)",
x = "Дата",
y = "Кількість злочинів") +
geom_point(data = date_phase[date_phase$phase == "Full M
oon", ], color = "red") +
geom_smooth()
library(ggplot2)
ggplot(date_phase, aes(Dates, n)) +
geom_line(alpha = 0.5) +
labs(title = "Злочини в Сан-Франциско (2003-2015)",
x = "Дата",
y = "Кількість злочинів") +
geom_point(data = date_phase[date_phase$phase == "Full Moon", ], color = "red") +
geom_smooth()
x <- mean(date_phase$n[date_phase$phase == "Full Moon"])
x
mu <- mean(date_phase$n[date_phase$phase != "Full Moon"])
mu
n <- length(date_phase$n[date_phase$phase == "Full Moon"])
n
s <- sd(date_phase$n[date_phase$phase == "Full Moon"])
s
p_value <- 2*pt(0.839, df=76, lower.tail = FALSE)
p_value
x_vector <- date_phase$n[date_phase$phase == "Full Moon"]
t.test(x_vector, mu = 391.75, alternative = "two.sided", conf.level = 0.95)
day_of_week_crimes <- full_data %>%
group_by(DayOfWeek) %>%
count()
glimpse(day_of_week_crimes)
ggplot(data=day_of_week_crimes, aes(x=DayOfWeek, y=n)) + geom_bar(stat="identity", fill="lightblue")
day_of_week_crimes$DayOfWeek <- factor(day_of_week_crimes$DayOfWeek , levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
ggplot(data=day_of_week_crimes, aes(x=DayOfWeek, y=n)) + geom_bar(stat="identity", fill="light blue")
crimes_by_day <- full_data %>%
group_by(Dates, DayOfWeek) %>%
count()
sample_vector <- crimes_by_day$n[crimes_by_day$DayOfWeek == "Friday"]
day_of_week_crimes$DayOfWeek <- factor(day_of_week_crimes$DayOfWeek , levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
ggplot(data=day_of_week_crimes, aes(x=DayOfWeek, y=n)) + geom_bar(stat="identity", fill="light blue")
View(day_of_week_crimes)
crimes_by_day <- full_data %>%
group_by(Dates, DayOfWeek) %>%
count()
sample_vector <- crimes_by_day$n[crimes_by_day$DayOfWeek == "Friday"]
sample_vector <- crimes_by_day$n[crimes_by_day$DayOfWeek == "Friday"]
# Розмір вибірки
n <- length(sample_vector)
n  # показати кількість спостережень
# Ступінь вільності
df <- n - 1
df
