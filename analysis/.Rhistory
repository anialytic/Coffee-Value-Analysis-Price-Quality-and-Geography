p.val< -2*pt(-0,02, df=99, lower.tail=FALSE)
p.val < -2*pt(-0,02, df=99, lower.tail=FALSE)
p.val <- 2*pt(-abs(-0.02), df=99)
p.val < -2*pt(-4.09, df=39, lower.tail=FALSE)
p.val <- 2*pt(-abs(-4.09), df=39)
library(lubridate)
install.packages("lubridate")
library(lubridate)
library(dplyr)
library(ggplot2)
crime <- read.csv("crimes.csv", header = TRUE)
crime <- read.csv("crimes.csv", header = TRUE)
getwd()
crime <- read.csv("C:\Users\HP\Documents\crimes.csv", header = TRUE)
crime <- read.csv("C:/Users/HP/Documents/crimes.csv", header = TRUE)
file.exists("C:/Users/HP/Documents/crimes.csv")
file.exists("C:/Users/HP/Documents/crimes.csv")
crime <- read.csv("C:/Users/HP/Documents/crimes.csv", header = TRUE)
str(crime)
crime$POSIX <- ymd_hms(as.character(crime$Dates))
crime$Dates <- as.Date(ymd_hms(as.character(crime$Dates)))
moon <- read.csv("moon.csv", header = TRUE)
moon <- read.csv("C:/Users/HP/Documents/moon.csv", header = TRUE)
moon$date <- as.Date(moon$date, "%m/%d/%Y")
full_data <- merge(crime, moon, by.x = "Dates", by.y="date")
full_data <- inner_join(crime, moon, by=c("Dates"="date"))
date_phase <- full_data %>%
group_by(Dates, phase) %>%
count() %>%
arrange(desc(n))
glimpse(date_phase)
library(ggplot2)
ggplot(date_phase, aes(Dates, n)) +
geom_line(alpha = 0.5) +
labs(title = "Злочини в Сан-Франциско (2003-2015)",
x = "Дата",
y = "Кількість злочинів") +
geom_point(data = date_phase[date_phase$phase == "Full M
oon", ], color = "red") +
geom_smooth()
library(ggplot2)
ggplot(date_phase, aes(Dates, n)) +
geom_line(alpha = 0.5) +
labs(title = "Злочини в Сан-Франциско (2003-2015)",
x = "Дата",
y = "Кількість злочинів") +
geom_point(data = date_phase[date_phase$phase == "Full Moon", ], color = "red") +
geom_smooth()
x <- mean(date_phase$n[date_phase$phase == "Full Moon"])
x
mu <- mean(date_phase$n[date_phase$phase != "Full Moon"])
mu
n <- length(date_phase$n[date_phase$phase == "Full Moon"])
n
s <- sd(date_phase$n[date_phase$phase == "Full Moon"])
s
p_value <- 2*pt(0.839, df=76, lower.tail = FALSE)
p_value
x_vector <- date_phase$n[date_phase$phase == "Full Moon"]
t.test(x_vector, mu = 391.75, alternative = "two.sided", conf.level = 0.95)
day_of_week_crimes <- full_data %>%
group_by(DayOfWeek) %>%
count()
glimpse(day_of_week_crimes)
ggplot(data=day_of_week_crimes, aes(x=DayOfWeek, y=n)) + geom_bar(stat="identity", fill="lightblue")
day_of_week_crimes$DayOfWeek <- factor(day_of_week_crimes$DayOfWeek , levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
ggplot(data=day_of_week_crimes, aes(x=DayOfWeek, y=n)) + geom_bar(stat="identity", fill="light blue")
crimes_by_day <- full_data %>%
group_by(Dates, DayOfWeek) %>%
count()
sample_vector <- crimes_by_day$n[crimes_by_day$DayOfWeek == "Friday"]
day_of_week_crimes$DayOfWeek <- factor(day_of_week_crimes$DayOfWeek , levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
ggplot(data=day_of_week_crimes, aes(x=DayOfWeek, y=n)) + geom_bar(stat="identity", fill="light blue")
View(day_of_week_crimes)
crimes_by_day <- full_data %>%
group_by(Dates, DayOfWeek) %>%
count()
sample_vector <- crimes_by_day$n[crimes_by_day$DayOfWeek == "Friday"]
sample_vector <- crimes_by_day$n[crimes_by_day$DayOfWeek == "Friday"]
# Розмір вибірки
n <- length(sample_vector)
n  # показати кількість спостережень
# Ступінь вільності
df <- n - 1
df
getwd()
library(dplyr)
library(ggplot2)
coffee <- read.csv('top-rated-coffee-clean.csv')
coffee <- read.csv('C:/Users/HP/Desktop/Coffee/top-rated-coffee-clean.csv')
coffee <- read.csv("C://Users//HP//Desktop//Coffee//top-rated-coffee-clean.csv")
coffee <- read.csv('top-rated-coffee-pp100(enc).csv')
coffee <- read.csv("C://Users//HP//Desktop//Coffee//top-rated-coffee-pp100(enc).csv")
coffee <- read.csv("top-rated-coffee-pp100(enc).csv", header = TRUE, sep = ";", fill = TRUE)
getwd()
coffee <- read.csv('top-rated-coffee-pp100g(enc).csv')
coffee <- read.csv("C://Users//HP//Desktop//Coffee//top-rated-coffee-pp100g(enc).csv")
coffee <- read.csv("top-rated-coffee-pp100g(enc).csv", header = TRUE, sep = ";", fill = TRUE)
readLines("top-rated-coffee-pp100g(enc).csv", n = 10)
mean(coffee$price_per_100g, na.rm = TRUE)
mean(coffee$price_per_100g)
class(coffee$price_per_100g)
mean(as.numeric(coffee$price_per_100g), na.rm = TRUE)
median(coffee$price_per_100g)
min(coffee$price_per_100g)
max(coffee$price_per_100g)
range(coffee$price_per_100g)
var(coffee$price_per_100g)
sd(coffee$price_per_100g)
summary(coffee$price_per_100g)
median(coffee$price_per_100g, na.rm = TRUE) # [1] "39,68"(до , na.rm = TRUE)
# мінімальна ціна за 100 г
min(coffee$price_per_100g, na.rm = TRUE)    # [1] ""(до , na.rm = TRUE)
# TODO: як уникнути порожнього значення
# максимальна ціна за 100 г
max(coffee$price_per_100g, na.rm = TRUE)    #[1] "99,21"(до , na.rm = TRUE)
# діапазон (мін, макс)
range(coffee$price_per_100g, na.rm = TRUE)  # [1] ""      "99,21"(до , na.rm = TRUE)
# дисперсія
var(coffee$price_per_100g, na.rm = TRUE)    # [1] NA(до , na.rm = TRUE)
# стандартне відхилення
sd(coffee$price_per_100g, na.rm = TRUE)
coffee %>%
slice_max(n=10, price_per_100g) %>%
arrange(desc(price_per_100g))
coffee %>%
slice_min(n=10, price_per_100g) %>%
arrange(desc(price_per_100g))
coffee %>%
slice_min(n=10, price_per_100g,na.rm = TRUE) %>%
arrange(desc(price_per_100g))
coffee %>%
slice_max(n=10, price_per_100g) %>%
arrange(desc(price_per_100g))
coffee_clean <- coffee[!is.na(coffee$country) & coffee$country != "", ]
coffee_counts <- table(coffee_clean$country)
barplot(coffee_counts,
las = 2,
col = "pink",
main = "Кількість типів кави по країнах",
ylab = "Кількість типів")
coffee$price_per_100g <- gsub(",", ".", coffee$price_per_100g)
barplot(coffee_counts,
las = 2,
col = "pink",
main = "Кількість типів кави по країнах",
ylab = "Кількість типів")
coffee$price_per_100g[coffee$price_per_100g == ""] <- NA
barplot(coffee_counts,
las = 2,
col = "pink",
main = "Кількість типів кави по країнах",
ylab = "Кількість типів")
coffee$price_per_100g <- as.numeric(coffee$price_per_100g)
barplot(coffee_counts,
las = 2,
col = "pink",
main = "Кількість типів кави по країнах",
ylab = "Кількість типів")
coffee_clean <- coffee[!is.na(coffee$country) & !is.na(coffee$price_per_100g), ]
barplot(coffee_counts,
las = 2,
col = "pink",
main = "Кількість типів кави по країнах",
ylab = "Кількість типів")
summary(coffee_clean$price_per_100g)
table(coffee_clean$country)
coffee$price_per_100g <- gsub(",", ".", coffee$price_per_100g)
# замінити порожні рядки на NA
coffee$price_per_100g[coffee$price_per_100g == ""] <- NA
# перетворити у числове значення
coffee$price_per_100g <- as.numeric(coffee$price_per_100g)
# перевірити колонку країни
coffee$country[coffee$country == ""] <- NA
summary(coffee_clean$price_per_100g)
table(coffee_clean$country)
library(dplyr)
library(ggplot2)
coffee <- read.csv('cleaned_top-rated-coffee-pp100g(enc).csv')
readLines("cleaned_top-rated-coffee-pp100g(enc).csv", n = 10)
coffee <- read.csv("C://Users//HP//Desktop//Coffee//cleaned_top-rated-coffee-pp100g(enc).csv")
coffee <- read.csv("cleaned_top-rated-coffee-pp100g(enc).csv", header = TRUE, sep = ";", fill = TRUE)
country_counts <- as.data.frame(table(df$Country))
names(df)
coffee <- read.csv("cleaned_top-rated-coffee-pp100g(enc).csv", header = TRUE, sep = ";", fill = TRUE)
readLines("cleaned_top-rated-coffee-pp100g(enc).csv", n = 10)
median(coffee$price_per_100g, na.rm = TRUE)
coffee %>%
slice_max(n=10, price_per_100g) %>%
arrange(desc(price_per_100g))
names(df)
country_counts <- as.data.frame(table(df$Country))
df <- read.csv("cleaned_data.csv", sep=";", header=FALSE, stringsAsFactors = FALSE)
df <- read.csv("cleaned_top-rated-coffee-pp100g(enc).csv", sep=";", header=FALSE, stringsAsFactors = FALSE)
colnames(df) <- c("coffee_name",	"total_score",	"roaster_location",	"coffee_origin",	"roast_level",	"est._price",	"agtron_ground",	"agtron_roast",	"price_per_100g",	"price_per_ounce",	"origin_country",	"clean_location",	"Country")
names(df)
head(df)
country_counts <- as.data.frame(table(df$Country))
ggplot(country_counts, aes(x = Var1, y = Freq)) +
geom_bar(stat = "identity", "pink) +
labs(x = "Країна", y = "Кількість", title = "Кількість кави по країнах") +
ggplot(country_counts, aes(x = Var1, y = Freq)) +
geom_bar(stat = "identity", "pink"") +
labs(x = "Країна", y = "Кількість", title = "Кількість кави по країнах") +
ggplot(country_counts, aes(x = Var1, y = Freq)) +
geom_bar(stat = "identity", "pink") +
labs(x = "Країна", y = "Кількість", title = "Кількість кави по країнах") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(country_counts, aes(x = reorder(Var1, -Freq), y = Freq)) +
geom_bar(stat = "identity", fill = "pink") +
labs(x = "Країна", y = "Кількість", title = "Кількість кави по країнах") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
coffee <- read.csv('coffe-cleaned.csv')
coffee <- read.csv("C://Users//HP//Desktop//Coffee//coffee-cleaned.csv")
coffee <- read.csv("C://Users//HP//Desktop//Coffee//coffee-cleaned.csv")
coffee <- read.csv("coffe-cleaned.csv", header = TRUE, sep = ";", fill = TRUE)
coffee <- read.csv("coffee-cleaned.csv", header = TRUE, sep = ";", fill = TRUE)
readLines("coffee-cleaned.csv", n = 10)
mean(coffee$price_per_100g)
class(coffee$price_per_100g)
median(coffee$price_per_100g, na.rm = TRUE)
min(coffee$price_per_100g, na.rm = TRUE)
max(coffee$price_per_100g, na.rm = TRUE)
range(coffee$price_per_100g, na.rm = TRUE)
var(coffee$price_per_100g, na.rm = TRUE)
sd(coffee$price_per_100g, na.rm = TRUE)
summary(coffee$price_per_100g)
coffee %>%
slice_max(n=10, price_per_100g) %>%
arrange(desc(price_per_100g))
library(dplyr)
library(ggplot2)
coffee %>%
slice_max(n=10, price_per_100g) %>%
arrange(desc(price_per_100g))
country_counts <- as.data.frame(table(df$Country))
ggplot(country_counts, aes(x = reorder(Var1, -Freq), y = Freq)) +
geom_bar(stat = "identity", fill = "pink") +
labs(x = "Країна", y = "Кількість", title = "Кількість кави по країнах") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
names(df)
df <- read.csv("cleaned_top-rated-coffee-pp100g(enc).csv", sep=";", header=FALSE, stringsAsFactors = FALSE)
coffee %>%
group_by(origin_country_clean) %>%
summarise(
mean_price = mean(price_per_100g, na.rm = TRUE),
median_price = median(price_per_100g, na.rm = TRUE),
max_price = max(price_per_100g, na.rm = TRUE),
n = n()
) %>%
arrange(desc(mean_price))
coffee %>%
group_by(origin_country_clean) %>%
summarise(
mean_price = mean(price_per_100g, na.rm = TRUE),
median_price = median(price_per_100g, na.rm = TRUE),
max_price = max(price_per_100g, na.rm = TRUE),
n = n()
) %>%
arrange(desc(median_price))
coffee %>%
group_by(origin_country_clean) %>%
summarise(
mean_price = mean(price_per_100g, na.rm = TRUE),
median_price = median(price_per_100g, na.rm = TRUE),
max_price = max(price_per_100g, na.rm = TRUE),
n = n()
) %>%
arrange(desc(max_price))
coffee %>%
group_by(origin_country_clean) %>%
summarise(
mean_price = mean(price_per_100g, na.rm = TRUE),
median_price = median(price_per_100g, na.rm = TRUE),
max_price = max(price_per_100g, na.rm = TRUE),
n = n()
) %>%
arrange(desc(median_price))
coffee %>%
filter(origin_country_clean %in% c("Guatemala", "Ethiopia", "Taiwan")) %>%
ggplot(aes(x = origin_country_clean, y = price_per_100g)) +
geom_boxplot() +
labs(title = "Coffee prices in Guatemala and Ethiopia",
x = "Country of Origin",
y = "Price per 100g")
coffee %>%
mutate(region = ifelse(origin_country_clean %in% c("Guatemala", "Ethiopia"),
"Guatemala/Ethiopia", "Other")) %>%
t.test(price_per_100g ~ region, data = ., alternative = "greater")
coffee %>%
group_by(origin_country_clean) %>%
summarise(
mean_price = mean(price_per_100g, na.rm = TRUE),
median_price = median(price_per_100g, na.rm = TRUE),
max_price = max(price_per_100g, na.rm = TRUE),
n = n()
) %>%
arrange(desc(median_price))
coffee %>%
slice_max(order_by = price_per_100g, n = 10) %>%
select(coffee_name, origin_country_clean, price_per_100g)
coffee %>%
mutate(region = ifelse(origin_country_clean %in% c("Guatemala", "Ethiopia"),
"Guatemala/Ethiopia", "Other")) %>%
t.test(price_per_100g ~ region, data = ., alternative = "greater")
coffee %>%
slice_max(order_by = price_per_100g, n = 10) %>%
select(coffee_name, origin_country_clean, price_per_100g)
readLines("coffee-cleaned.csv", n = 10)
library(dplyr)
library(ggplot2)
coffee <- read.csv("coffee-cleaned.csv", header = TRUE, sep = ";", fill = TRUE)
getwd()
getwd()
coffee <- read.csv("coffee-cleaned.csv", header = TRUE, sep = ";", fill = TRUE)
install.packages(c("tidyverse", "Hmisc", "corrplot", "GGally", "psych", "ggcorrplot"))
library(tidyverse)
library(Hmisc)
library(corrplot)
library(GGally)
head(df)
str(df)
summary(df)
str(df$roast_level)
str(df$total_score)
df %>%
group_by(roast_level) %>%
summarise(
n = n(),
mean_score = mean(total_score, na.rm = TRUE),
sd_score = sd(total_score, na.rm = TRUE)
)
str(df$total_score)
df$total_score <- gsub(",", ".", df$total_score)
df$total_score <- as.numeric(df$total_score)
str(df$total_score)
df %>%
group_by(roast_level) %>%
summarise(
n = n(),
mean_score = mean(total_score, na.rm = TRUE),
sd_score = sd(total_score, na.rm = TRUE)
)
df <- df %>%
mutate(
roast_level = na_if(roast_level, ""),
roast_level = ifelse(roast_level == "roast_level", NA, roast_level)
)
df$roast_level <- as.factor(df$roast_level)
df %>%
group_by(roast_level) %>%
summarise(
n = n(),
mean_score = mean(total_score, na.rm = TRUE),
sd_score = sd(total_score, na.rm = TRUE)
) %>%
arrange(desc(n))
anova_result <- aov(total_score ~ roast_level, data = df)
summary(anova_result)
ggplot(df, aes(x = roast_level, y = total_score, fill = roast_level)) +
geom_boxplot() +
theme_minimal() +
labs(
title = "Розподіл Total Score за Roast Level",
x = "Рівень обсмаження",
y = "Загальний бал"
)
TukeyHSD(anova_result)
library(dplyr)
library(ggplot2)
coffee <- read.csv('coffee-cleaned.csv')
coffee <- read.csv("coffee-cleaned.csv", header = TRUE, sep = ";", fill = TRUE)
readLines("coffee-cleaned.csv", n = 10)
cor(price_per_100g$coffee, total_score$coffee, use = "complete.obs")
head(coffee)
cor(price_per_100g$coffee, total_score$coffee, use = "complete.obs")
View(coffee)
summary(coffee)
cor(price_per_100g$coffee,total_score$coffee, use = "complete.obs")
ls()
head(total_score)
head(price_per_100g)
cor(coffee$price_per_100g, coffee$total_score, use = "complete.obs")
plot(coffee$total_score, coffee$price_per_100g,
main = "Зв'язок між total_score і price_per_100g",
xlab = "total_score",
ylab = "price_per_100g",
pch = 19,        # форма точок (19 — заповнене коло)
col = "blue")    # колір точок
# Додати лінію тренду
abline(lm(price_per_100g ~ total_score, data = coffee), col = "red", lwd = 2)
ggplot(coffee, aes(x = total_score, y = price_per_100g)) +
geom_point(color = "blue") +
geom_smooth(method = "lm", se = FALSE, color = "red") +
labs(title = "Зв'язок між total_score і price_per_100g",
x = "total_score",
y = "price_per_100g")
ggplot(coffee, aes(x = total_score, y = price_per_100g)) +
geom_point(color = "pink") +
geom_smooth(method = "lm", se = FALSE, color = "violet") +
labs(title = "Зв'язок між total_score і price_per_100g",
x = "total_score",
y = "price_per_100g")
ggplot(coffee, aes(x = total_score, y = price_per_100g)) +
geom_point(color = "pink") +
geom_smooth(method = "lm", se = FALSE, color = "violet") +
labs(title = "Зв'язок між оцінкою якості і ціною за 100г (у доларах США)",
x = "Оцінка якості",
y = "Ціна за 100 г (у доларах США)")
View(coffee)
cor(coffee$agtron_roast, coffee$price_per_100g, use = "complete.obs")
cor(coffee$price_per_100g, coffee$total_score, use = "complete.obs")
cor(coffee$agtron_roast, coffee$price_per_100g, use = "complete.obs")
cor(coffee$agtron_ground, coffee$price_per_100g, use = "complete.obs")
cor(coffee$total_score, coffee$agtron_roast, use = "complete.obs")
cor(coffee$total_score, coffee$agtron_ground, use = "complete.obs")
library(dplyr)
library(ggplot2)
coffee <- read.csv("coffee-cleaned.csv", header = TRUE, sep = ";", fill = TRUE)
plot(coffee)
head(coffee)
summary(coffee)
library(dplyr)
library(ggplot2)
summary(coffee)
plot(coffee)
plot(coffee$roaster_location, coffee$total_score,
col = '#cc0000',
pch = 19,
main ='Coffee: score vs. roaster location',
xlab = 'Roaster location',
ylab='Total score')
plot(coffee$agtron_ground, coffee$agtron_roast,
col = "#cc0000",
pch = 19,
main ="Coffee: agtron_ground vs. agtron_roast",
xlab = "Agtron ground",
ylab = "Agtron roast")
cor(coffee$agtron_ground, coffee$agtron_roast, use = "complete.obs")
